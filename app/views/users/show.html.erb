<%= render "shared/header" %>

<div class="container">
  <h4 class="mt-3"><%= @user.nickname %>さんのページ</h4>
  <ul>
    <li>年齢　：<%= @user.user_detail&.age %></li>
    <li>性別　：<%= @user.user_detail&.gender&.name %></li>
    <li>居住地：<%= @user.user_detail&.prefecture&.name %> <%= @user.user_detail&.city %></li>
    <li>趣味　：<%= @user.user_detail&.hobby %></li>
  </ul>
  <% if current_user&.id == @user.id %>
    <%= link_to "登録情報を編集する", edit_user_path(current_user) %><br>
    <% if current_user.user_detail.present? %>
      <%= link_to "詳細情報を編集する", edit_user_user_detail_path(current_user, current_user.user_detail) %>
    <% else %>
      <%= link_to "詳細情報を登録する", new_user_user_detail_path(current_user) %>
    <% end %>
  <% end %>
</div>

<div class="event-wrapper container my-5 p-0">
  <div class="event-wrapper-second">
    <h4>主催中のイベント</h4>
    <%= render partial: 'home/room_index', locals: {rooms: @rooms } %>
  </div>
</div>

<% if current_user&.id == @user.id %>
  <div class="event-wrapper container my-5 p-0">
    <div class="event-wrapper-second">
      <h4>いいねしたイベント</h4>
      <ul class="row p-3">
        <% current_user.goods.each do |good| %>
          <% user = User.find(good.room.create_user_id) %>
          <div class="col-3 p-4">
            <li class='event-list-item<%= user.user_detail.gender_id %>'>
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title">
                    <% if good.room.name.present? %>
                      <div><%= link_to good.room.name, room_path(good.room) %></div>
                    <% else %>
                      <div><%= link_to "#{good.room.room_detail&.date}＠#{good.room.room_detail&.place}", room_path(good.room) %></div>
                    <% end %>
                  </h5>
                  <div class="card-text mb-1"><%= good.room.room_detail&.place %></div>
                  <div class="card-text mb-1"><%= good.room.room_detail&.date %></div>
                  <div class="card-text mb-1"><%= good.room.room_detail&.number_of_people %>人 - <%= good.room.room_detail&.number_of_people %>人</div>
                  <div class="card-text mb-1"><%= good.room.room_detail&.atmosphere %></div>
                  <div class="card-text mb-1"><%= good.room.room_detail&.treat&.name %></div>
                  <div class="card-text mb-1">主催者：<%= link_to user.nickname, user_path(user), class:'card-link' %></div>
                </div>
              </div>
            </li>
          </div>
        <% end %>
      </ul>
    </div>
  </div>

  <div class="event-wrapper container my-5 p-0">
    <div class="event-wrapper-second">
      <h4>参加中のイベント</h4>
      <%= render partial: 'home/room_index', locals: {rooms: @user.rooms } %>
    </div>
  </div>
<% end %>

<%= render "shared/footer" %>